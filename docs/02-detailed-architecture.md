# HengBeGer 详细架构分析

## 项目概述

HengBeGer 是一个基于 React 19 + Express.js + MySQL 的全栈绝区零游戏图鉴应用，采用前后端分离架构，实现了代理人、音擎、邦布、驱动盘等游戏数据的展示和管理功能。项目具有双存储架构、响应式设计、完整的CRUD操作等特色。

## 核心架构设计

### 1. 前端架构层次

```
┌─────────────────────────────────────────────────────────────┐
│                    应用入口层 (main.jsx)                      │
├─────────────────────────────────────────────────────────────┤
│                    路由管理层 (App.jsx)                       │
├─────────────────────────────────────────────────────────────┤
│                  数据上下文层 (DataContext.jsx)                │
├─────────────────────────────────────────────────────────────┤
│  业务组件层                                                   │
│  ┌─────────────────┐  ┌─────────────────┐                   │
│  │   ZZZWiki.jsx   │  │ AdminPanel.jsx  │                   │
│  │   (数据展示)     │  │   (数据管理)     │                   │
│  └─────────────────┘  └─────────────────┘                   │
├─────────────────────────────────────────────────────────────┤
│                  功能组件层 (Filter.jsx)                      │
└─────────────────────────────────────────────────────────────┘
```

#### 1.3 数据上下文层 (DataContext.jsx)
- 全局状态管理、API 调用封装、数据缓存
- 核心状态包含 agents/soundEngines/bumbos/driveDisks 等

### 2. 后端架构层次

```
┌─────────────────────────────────────────────────────────────┐
│                    服务入口层 (server/index.js)               │
├─────────────────────────────────────────────────────────────┤
│                    API 服务层 (src/db/api.js)                │
├─────────────────────────────────────────────────────────────┤
│                  双存储管理层 (dualStorageManager.js)          │
├─────────────────────────────────────────────────────────────┤
│                  数据访问层 (models/*.js)                     │
├─────────────────────────────────────────────────────────────┤
│                  数据库层 (MySQL + Sequelize)                 │
└─────────────────────────────────────────────────────────────┘
```

### 3. 数据流分析与映射
- 前端方法到 API 的映射：fetchData、addAgent、updateAgent、deleteAgent
- 数据库字段到前端属性的映射：id/name/element 等
- 双存储系统路径映射：web/admin/backup